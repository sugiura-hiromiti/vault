---
id: 25071712262656
aliases: []
tags: []
created: 250717 12:26:26
updated: 250717 13:08:12
---


https://doc.rust-jp.rs/book-ja/ch04-00-understanding-ownership.html

https://doc.rust-jp.rs/book-ja/ch04-01-what-is-ownership.html

# 先週

>[!Abstract]+
>rustの基本的な言語機能を学習しました

## レジュメ回答

先週分を参照

# 今週

>[!Abstract]+
>Rustの所有権を学びます
>所有権を理解する為に必要なCSの基礎的な知識も一緒に身につけましょう！

## 論点

1. なぜスタックとヒープを区別する必要があるのだろう
2. 所有権とスコープはどう関係しているだろうか
3. ムーブせマンティクスは二重解放エラーをどの様に回避するか
4. `Copy`トレイトがあると何が嬉しいのだろう

## 理解度確認

1. `String`型の値はスタックに積まれる
	1. yes
	2. no
2. RustはGCを利用している
	1. yes
	2. no
3. shadowingの際に所有権がどの様に変化するか記述してみましょう
4. move, shallow copy, deep copyの際に新たに作られるデータはそれぞれどれだろう
	1. メタデータ
	2. データ本体


6. コンパイルエラーを引き起こすのは何行目？
```rust
let tup: (i32, f64, u8) = (500, 6.4, 1);
let (x, y, z) = tup;
let five_hundred = tup.0;
let one = tup.3;
```

1. 以下の関数は何を返す？
```rust
fn mystery_function(x: i32) -> i32 {
    x + 1;
}
```
a) x + 1  b) ()  c) コンパイルエラー  d) x

1. 有効な関数シグネチャはどれ？
	1. `fn add(x: i32, y: i32) -> i32`
	2. `fn add(x, y) -> i32`
	3. `fn add(x: i32, y: i32): i32`
	4. `function add(x: i32, y: i32) -> i32`

2. `number`の値は？
```rust
let condition = true;
let number = if condition { 5 } else { 6 };
```

## 課題

外部クレートの利用は制限しません
AIの利用はなるべく控えて挑戦してみましょう

### drop

Rustにおけるdropとは何かを説明してみましょう

>[!Info] ヒント
>- Dropトレイトの役割を考えてみよう
>- dropの概念がなかったとしたらどうなるだろうか
>- 所有権との関係性をイメージしてみよう

### 所有権エラー

所有権由来のエラーを起こすプログラムを3つ作りましょう
そしてそれぞれのプログラムを修正してみましょう

### コピーとクローン

`Copy`トレイトと`Clone`トレイトの違いを説明してみましょう

## 高度な課題

外部クレート、AIの利用は制限しません

### カスタム`Drop`実装

ほとんどの場合`Drop`トレイトが必要な型には自動で`Drop`トレイトの実装が生成されますが、勿論自分で実装することもできます

保持するフィールドの各データをバックアップとして特定のファイルに書き込む構造体を作成してください
この構造体がdropする際に、バックアップデータも共に削除する様`Drop`トレイトを実装してみましょう